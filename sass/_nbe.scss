@import 'nbe_variables';

/**
 * Use this to declare user-defined edge types.
 */
@mixin edgeType( $themeName, $name, $color ) {

   .graph.#{$themeName} {
      // Colored vertex node ports:
      .port.#{$name} > i {
         background: $color;
      }

      // Colored edge nodes:
      .node.edge.#{$name} {
         background: -moz-linear-gradient(left top, $color 0%, darken($color, 20%) 100%);
         background: -webkit-gradient(linear, left top, right bottom, color-stop(0%, $color), color-stop(100%, darken($color, 30%)));
      }

      // Colored links (svg):
      .link.#{$name} {
         stroke: $color;
         &.selected {
            stroke: lighten( $color, 20 );
         }
      }

      // When highlightin this edge type (e.g. on drag drop), grey out edges of other types:
      &.highlight-#{$name} {
         .port:not(.#{$name}) > i,
         .node.edge:not(.#{$name}) {
            background: $unHighlightColor;
         }
         .link:not(.#{$name}) {
            stroke: $unHighlightColor;
         }
      }
   }

}



body {
   background: $bgColor;
}

[data-ng-cloak] {
   display: none !important;
}

.graph {

   .graph-contents {
      background:
      linear-gradient(
                      0deg,
                      transparent 24%, rgba(255, 255, 255, .05) 25%, rgba(255, 255, 255, .05) 26%, transparent 27%,
                      transparent 74%, rgba(255, 255, 255, .05) 75%, rgba(255, 255, 255, .05) 76%, transparent 77%,
                      transparent),
      linear-gradient(
                      90deg,
                      transparent 24%, rgba(255, 255, 255, .05) 25%, rgba(255, 255, 255, .05) 26%, transparent 27%,
                      transparent 74%, rgba(255, 255, 255, .05) 75%, rgba(255, 255, 255, .05) 76%, transparent 77%,
                      transparent);
      background-size: 50px 50px;
      width: 100%;
      height: 100%;
   }

   svg {
      width: 100%;
      height: 100%;
   }

   .links {
   }

   background: $graphBgColor;
   border-radius: 10px;

   font-family: $fontFamilyLabel;
   font-size: $fontSizeLabel;
   color: $textColor;

   * {
      user-select: none;
      -moz-user-select: none;
      -webkit-user-select: none;
      cursor: default;
   }

   .port {
      i {
         width: $portAnchorSize;
         height: $portAnchorSize;
         background: $typeColor1;
         border: solid $gray2 1px;
         border-radius: 6px;
         margin: 3px 5px -3px 5px;
         display: inline-block;
         position: relative;
      }
      i:hover {
         opacity: 0.5;
      }
   }

   .node {
      position: absolute;
      border: solid $nodeBorderColor 1.5px;

      &.vertex {
         box-shadow: 4px 4px 6px $nodeShadowColor;

         border-radius: 10px;
         background: -moz-linear-gradient(left top, $vertexBgColor 0%, darken($vertexBgColor, 30%) 100%);
         background: -webkit-gradient(linear, left top, right bottom, color-stop(0%, $vertexBgColor), color-stop(100%, darken($vertexBgColor, 30%)));

         .header {
            border-radius: 10px 10px 0px 0px;
            height: $nodeTitleHeight;
            text-align: center;
            background: rgba(0, 0, 0, 0.15);
            padding: 2px 5px 1px 5px;
            font-size: $fontSizeLabel;
            font-family: $fontFamilyLabel;
            text-shadow: 1px 1px 0.5px $gray2;
         }

         .port-group {

            background: rgba(0, 0, 0, 0.05);
            border-top: solid $nodeBorderColor 1px;

            // Flex container:
            display: -webkit-flex;
            -webkit-flex-direction: row;
            -webkit-align-items: flex-start;

         }

         .ports {
            // Flex item:
            -webkit-flex: 0 1 auto;

            // Flex container:
            display: -webkit-flex;
            -webkit-flex-flow: column;
            -webkit-justify-content: stretch;

            &.in {
               border-right: 1px solid $gray4;
               -webkit-align-items: flex-start;
               .port { text-align: left; padding-right: 9px; }
            }

            &.out {
               -webkit-align-items: flex-end;
               .port { text-align: right; padding-left: 9px; }
            }
         }

         .port {
            -webkit-flex: 0 1 auto;
            line-height: $portHeight;
            padding-top: 0;
            color: $portTextColor;
            font-size: $fontSizePort;
            font-family: $fontFamilyPort;
            text-shadow: 0 0 2px $gray7;
            white-space: nowrap;
         }

      }

      // Default edge-node style;
      &.edge {
         width: $edgeNodeSize;
         height: $edgeNodeSize;
         background: linear-gradient(135deg, $typeColor1 0%, darken($typeColor1, 20%) 100%);
         border-radius: $edgeNodeSize;
         box-shadow: 4px 4px 4px $gray0;

         label {
            display: block;
            position: relative;
            width: 100px;
            left: -50px + $edgeNodeSize/2;
            text-align: center;
            text-shadow: 4px 4px 4px $gray0;
            top: $edgeNodeSize + 2px;
            font-family: $fontFamilyLabel;
            font-size: $fontSizeLabel;
         }

      }

      &.selected {
         box-shadow: 0px 0px 8px #fff, 4px 4px 4px $gray0;
      }
   }

   .GHOST {
      position: absolute;
   }

   .links {
      .link {
         position: absolute;
         fill: transparent;
      }
      .link {
         stroke-width: 2;
      }
   }

   .tools {
      position: absolute;
      top: 0;
      left: 0;

      button {
         opacity: 0.5;
         &:hover {
            opacity: 1;
         }
      }
   }
}
